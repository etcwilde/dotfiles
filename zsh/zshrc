# zshrc
# Evan Wilde
#

# check if a program exists in the user's path
prog_exists() {
        if hash $1 2>/dev/null; then
                return 0
        else
                return 1
        fi
}

export PATH="$HOME/.bin:$HOME/.dotfiles/bin:$HOME/.local/bin:/usr/local/bin:/usr/bin:/bin:/opt/bin:/usr/local/sbin:/usr/sbin:/sbin:$PATH"
export GOPATH="$HOME/.local/lib/go/"
export TZ=':/etc/localtime'

if prog_exists 'nvim'; then
        export EDITOR='nvim'
elif prog_exists 'vim'; then
        export EDITOR='vim'
fi

[[ "$TERM" == "xterm" ]] && export TERM=xterm-256color

# Variables
export ARCHFLAGS="-arch x86_64"
ZSH=~/.config/zsh
ANTIGEN=$ZSH/antigen/antigen.zsh
ENABLE_CORRECTION="true"
COMPLETION_WAITING_DOTS="true"

# Include custom completion functions
fpath=($ZSH/completions/ $fpath)

# External configurations
[ -f $ZSH/aliases.zsh ] && . $ZSH/aliases.zsh
[ -f $ZSH/history.zsh ] &&  . $ZSH/history.zsh
[ -f $ZSH/prompt.zsh ] && . $ZSH/prompt.zsh
[ -f $ZSH/private.zsh ] && . $ZSH/private.zsh

autoload -U compinit && compinit
autoload -U +X bashcompinit && bashcompinit

# Vim keybindings
bindkey -v

# Library Variables
export LD_LIBRARY_PATH="$LD_LIBRARY_PATH:/opt/lib/:/opt/lib/cuda:/opt/lib/cuddn"
export CUDA_HOME="/opt/src/cuda/"
export SSH_AUTH_SOCK="$XDG_RUNTIME_DIR/ssh-agent.socket"

# Syntax highlighting if available
[[ -f /usr/share/zsh/plugins/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh ]] && . /usr/share/zsh/plugins/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh

# Fuzzy tab completion
# Vanilla completion
# Smart-case completion
# Word-flex
# Full flex completion
zstyle ':completion:*' matcher-list '' \
  'm:{a-z\-}={A-Z\_}' \
  'r:[^[:alpha:]]||[[:alpha:]]=** r:|=* m:{a-z\-}={A-Z\_}' \
  'r:|?=** m:{a-z\-}={A-Z\_}'

# Options
setopt autocd
setopt correct
setopt histignoredups
setopt histignorespace
